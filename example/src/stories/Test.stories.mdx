import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs';
import { PhotoProvider, PhotoConsumer } from 'vue3-photo-preview';
import { ViewBox, imgList } from '../main.ts';
import originPhotoProvider from 'vue3-photo-preview/src/PhotoProvider/index.vue';
import originPhotoConsumer from 'vue3-photo-preview/src/PhotoConsumer/index.vue'
import 'vue3-photo-preview/dist/index.css';

<Meta title="vue3-photo-preview" />

## 默认展示
<Canvas>
  <Story name="默认展示">
    {
      () => ({
        setup() {
          return {
            imgList
          }
        },
        components: { PhotoProvider, PhotoConsumer, ViewBox },
        template: `
          <photo-provider>
            <photo-consumer v-for="src in imgList" :intro="src" :key="src" :src="src">
              <ViewBox :src="src" />
            </photo-consumer>
          </photo-provider>
        `
      })
    }
  </Story>
</Canvas>

## 通过按钮触发
<Canvas>
  <Story name="通过按钮触发">
    {
      () => ({
        setup() {
          return {
            imgList
          }
        },
        components: { PhotoProvider, PhotoConsumer },
        template: `
          <photo-provider>
            <photo-consumer v-for="(src, index) in imgList" :intro="src" :key="src" :src="src">
              <button v-if="index === 0">打开预览</button>
            </photo-consumer>
          </photo-provider>
        `
      })
    }
  </Story>
</Canvas>

## 异步更新图片地址
<Canvas>
  <Story name="异步更新图片地址">
    {
      () => ({
        data() {
          return {
            index: 0,
          }
        },
        computed: {
          imageSrc() {
            return imgList[this.index];
          }
        },
        methods: {
          asyncChangeSrc() {
            setTimeout(() => {
              const index = this.index + 1;
              this.index = index % imgList.length;
            }, 3000)
          }
        },
        components: { PhotoProvider, PhotoConsumer },
        template: `
          <photo-provider>
            <photo-consumer :intro="imageSrc" :src="imageSrc">
              <button @click="asyncChangeSrc">打开预览</button>
            </photo-consumer>
          </photo-provider>
        `
      })
    }
  </Story>
</Canvas>

## Props

### PhotoProvider

<ArgsTable of={originPhotoProvider} />

### PhotoConsumer

<ArgsTable of={originPhotoConsumer} />
